import"./main-B8eGK_zR.js";class l{async searchTracks(t){try{const r=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(t)}&entity=musicTrack&country=US`);if(!r.ok)throw new Error("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏");const e=await r.json();return!e.results||e.results.length===0?this.getDemoTracks(t):e.results.map(i=>({name:i.trackName,artist:i.artistName,album:i.collectionName||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–ª—å–±–æ–º",image:i.artworkUrl100?i.artworkUrl100.replace("100x100bb","250x250bb"):this.getDefaultImage(),preview:i.previewUrl}))}catch(r){return console.error("Music API error:",r),this.getDemoTracks(t)}}async getTopTracks(){try{const t=["pop","rock","hip hop","electronic","r&b","dance"],r=t[Math.floor(Math.random()*t.length)],e=await fetch(`https://itunes.apple.com/search?term=${r}&entity=musicTrack&country=US`);if(!e.ok)throw new Error("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏");const i=await e.json();return!i.results||i.results.length===0?this.getDemoTopTracks():i.results.map(n=>({name:n.trackName,artist:n.artistName,album:n.collectionName||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∞–ª—å–±–æ–º",image:n.artworkUrl100?n.artworkUrl100.replace("100x100bb","250x250bb"):this.getDefaultImage(),preview:n.previewUrl}))}catch(t){return console.error("Top tracks error:",t),this.getDemoTopTracks()}}getDefaultImage(){return"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=250&h=250&fit=crop"}getDemoTracks(t){const r=this.getDemoTopTracks(),e=r.filter(i=>i.name.toLowerCase().includes(t.toLowerCase())||i.artist.toLowerCase().includes(t.toLowerCase()));return e.length>0?e:r.slice(0,4)}getDemoTopTracks(){return[{name:"Blinding Lights",artist:"The Weeknd",album:"After Hours",image:"https://is1-ssl.mzstatic.com/image/thumb/Music124/v4/d1/3d/33/d13d33a9-91c9-d555-7b71-241ac2cb0a0a/20UMGIM53933.rgb.jpg/250x250bb.jpg",preview:"https://audio-ssl.itunes.apple.com/itunes-assets/AudioPreview115/v4/50/5c/32/505c32a1-04e5-8f6f-8676-6e4c24c0a837/mzaf_13346412281003489284.plus.aac.p.m4a"},{name:"Flowers",artist:"Miley Cyrus",album:"Endless Summer Vacation",image:"https://is1-ssl.mzstatic.com/image/thumb/Music123/v4/60/0a/6c/600a6c87-ecd7-5e1b-5b13-7e8c4d811d41/23UMGIM89099.rgb.jpg/250x250bb.jpg",preview:"https://audio-ssl.itunes.apple.com/itunes-assets/AudioPreview116/v4/5e/4b/3c/5e4b3c9c-7d8b-8c8c-7b4f-7e9e4b3c9c7d/mzaf_13346412281003489284.plus.aac.p.m4a"}]}}class u{constructor(){this.currentAudio=null,this.currentPlayingButton=null}playAudio(t,r){if(this.currentPlayingButton===r&&this.currentAudio){this.currentAudio.paused?(this.currentAudio.play(),r.innerHTML="‚è∏",r.classList.add("playing")):(this.currentAudio.pause(),r.innerHTML="‚ñ∂",r.classList.remove("playing"));return}if(this.currentAudio&&(this.currentAudio.pause(),this.currentPlayingButton&&(this.currentPlayingButton.innerHTML="‚ñ∂",this.currentPlayingButton.classList.remove("playing"))),!t){r.style.opacity="0.5";return}try{this.currentAudio=new Audio(t),this.currentPlayingButton=r,r.innerHTML="‚è∏",r.classList.add("playing"),this.currentAudio.play(),this.currentAudio.onended=()=>this.onAudioEnded(),this.currentAudio.onerror=()=>this.onAudioError()}catch(e){console.error("Audio error:",e),this.onAudioError()}}onAudioEnded(){this.currentPlayingButton&&(this.currentPlayingButton.innerHTML="‚ñ∂",this.currentPlayingButton.classList.remove("playing")),this.currentAudio=null,this.currentPlayingButton=null}onAudioError(){this.currentPlayingButton&&(this.currentPlayingButton.innerHTML="‚ñ∂",this.currentPlayingButton.classList.remove("playing"),this.currentPlayingButton.style.opacity="0.5"),this.currentAudio=null,this.currentPlayingButton=null}}const a=new l,d=new u;document.getElementById("search-btn")?.addEventListener("click",o);document.getElementById("search-input")?.addEventListener("keypress",s=>{s.key==="Enter"&&o()});async function o(){const s=document.getElementById("search-input"),t=document.getElementById("music-results"),r=s.value.trim();if(!r){t.innerHTML='<div class="error">–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞ –∏–ª–∏ –∞—Ä—Ç–∏—Å—Ç–∞</div>';return}t.innerHTML='<div class="loading">–ü–æ–∏—Å–∫ –º—É–∑—ã–∫–∏ –≤ iTunes...</div>';try{const e=await a.searchTracks(r);if(e.length===0){t.innerHTML='<div class="error">–ú—É–∑—ã–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –∑–∞–ø—Ä–æ—Å</div>';return}c(e,"–ù–∞–π–¥–µ–Ω–æ")}catch(e){console.error("Search error:",e),t.innerHTML='<div class="error">–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –º—É–∑—ã–∫–∏</div>'}}function c(s,t){const r=document.getElementById("music-results");r.innerHTML=`
        <div style="text-align: center; margin-bottom: 1rem; color: #4a5568; font-size: 0.9rem;">
            üéµ ${t} ${s.length} —Ç—Ä–µ–∫–æ–≤
        </div>
        <div class="playlist-container">
            <div class="playlist-header">
                <div>#</div>
                <div class="header-image">  </div>
                <div>–ù–∞–∑–≤–∞–Ω–∏–µ</div>
                <div>–ê—Ä—Ç–∏—Å—Ç</div>
                <div>–ê–ª—å–±–æ–º</div>
                <div class="header-preview">–ü—Ä–µ–≤—å—é</div>
            </div>
            ${s.map((e,i)=>`
                <div class="track-row">
                    <div class="track-number">${i+1}</div>
                    <img src="${e.image}" alt="${e.album}" class="track-image">
                    <div class="track-name" title="${e.name}">${e.name}</div>
                    <div class="track-artist" title="${e.artist}">${e.artist}</div>
                    <div class="track-album" title="${e.album}">${e.album}</div>
                    <div class="track-preview">
                        ${e.preview?`<button class="play-button" data-preview="${e.preview}">
                                ‚ñ∂
                            </button>`:'<span style="color: #a0aec0; font-size: 0.8rem;">‚Äî</span>'}
                    </div>
                </div>
            `).join("")}
        </div>
    `,document.querySelectorAll(".play-button").forEach(e=>{e.addEventListener("click",function(){const i=this.getAttribute("data-preview");d.playAudio(i,this)})})}document.addEventListener("DOMContentLoaded",async()=>{const s=document.getElementById("music-results");if(s&&s.innerHTML.includes("–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫"))try{const t=await a.getTopTracks();t.length>0&&c(t,"–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ")}catch{}});
